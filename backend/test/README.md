# テスト構成

## ディレクトリ構造

```
test/
├── unit/                   # ユニットテスト
│   └── controllers/        # コントローラーのテスト
├── integration/            # 統合テスト
├── e2e/                    # エンドツーエンドテスト
├── utils/                  # テストユーティリティ
├── fixtures/               # テストデータ
├── mocks/                  # モックファイル
└── README.md               # このファイル
```

## テストの種類

### ユニットテスト (`test/unit/`)
- 個々のコンポーネント（コントローラー、サービス、ミドルウェア）のテスト
- 依存関係をモック化
- 高速実行

### 統合テスト (`test/integration/`)
- 複数のコンポーネント間の連携テスト
- OpenAPI仕様との整合性テスト
- データベース操作を含む

### E2Eテスト (`test/e2e/`)
- アプリケーション全体のワークフローテスト
- 実際のHTTPリクエスト/レスポンス
- ユーザーシナリオベース

## 実行方法

```bash
# 全テスト実行
npm test

# ユニットテストのみ
npm run test:unit

# 統合テストのみ
npm run test:integration

# E2Eテストのみ
npm run test:e2e

# カバレッジ付きテスト
npm run test:coverage

# ウォッチモード
npm run test:watch
```

## テストユーティリティ

### `test/utils/testHelpers.js`
- テストデータ生成関数
- 共通のアサーション関数
- リクエストヘルパー

### `test/utils/setup.js`
- テスト環境のセットアップ
- グローバル設定
- モック設定

## テストデータ

### `test/fixtures/`
- 静的テストデータ
- JSON形式でのサンプルデータ

### `test/mocks/`
- OpenAPIモック
- 外部サービスのモック

## ベストプラクティス

1. **テストの独立性**: 各テストは他のテストに依存しない
2. **データクリーンアップ**: テスト後は状態をリセット
3. **明確な命名**: テスト名は期待する動作を明確に表現
4. **適切なモック**: 必要な部分のみをモック化
5. **エラーケース**: 正常系だけでなく異常系もテスト